<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>Word Waterfall</title>
		<meta name="author" content="Simon Last" />
		<meta name="twitter:card" content="photo">
  	<meta name="twitter:creator" content="@simonlast">
  	<meta name="twitter:title" content="Word Waterfall">
  	<meta name="twitter:image" content="http://simonlast.org/screens/waterfall1.png">
		<link rel="shortcut icon" href="http://www.gravatar.com/avatar/3b964d84fcfbcdf59089c8bd7309f0b7.ico" />
		<link rel="stylesheet" type="text/css" href="/styles/style-static.css" />
		<script type="text/javascript" src="//use.typekit.net/suk0ird.js"></script>
		<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
	</head>
	<body class="article">

		<div class="background-image">
			<img src="/screens/waterfall1.png" alt="" />
		</div>

		<div class="header">
			<h1>Word Waterfall</h1>
		</div>

		<div class="content">

				<div class="about-text">
					<p>Word Waterfall is an experiment in realtime collaboration on the web.</p>

<p>Players are arranged into a &quot;waterfall,&quot; with the top of one players screen representing the bottom of another, and vice versa. When a word drops past the bottom of a screen, it appears at the top of the screen of the player directly below. Conversely, when a group of words floats past the top of a screen, it appears at the bottom of another player&#39;s. </p>

<p>The goal of this experiment is to create a free-form collaborative environment where users interact by suggesting interesting combinations of words. In this way, the most interesting phrases will make their way to the very top of the waterfall, where they appear globally on the site. </p>
				</div>

				<div class="links">
					
						<a href="http://waterfall.simonlast.org">Launch</a>
					
						<a href="http://github.com/simonlast/waterfall">Source</a>
					
				</div>
			</div>

		</div>

		<script type="text/javascript">

			var backgroundImage = document.querySelector(".background-image img");

			var loadBackground = function(){

				var canvas = document.createElement("canvas");
				canvas.width = backgroundImage.width;
				canvas.height = backgroundImage.height;

				var ctx = canvas.getContext("2d");
				ctx.drawImage(backgroundImage, 0, 0, backgroundImage.width, backgroundImage.height);
				// var color = getVerticalLineAverage(ctx, 0, backgroundImage.height);
				var color = getPixel(ctx, 0, 0);
				var imageContainer = document.querySelector(".background-image")

				var cssColor = "rgba(" + color[0] + "," + color[1] + "," + color[2] + "," + color[3] + ")";

				console.log("cssColor: ", cssColor);

				imageContainer.style["background-color"] = cssColor

			};

			getVerticalLineAverage = function(ctx, x, height){
				var average = [0, 0, 0, 0];

				for(var y=0; y<height; y++){
					var pixel = getPixel(ctx, x, y);

					for (var i = pixel.length - 1; i >= 0; i--) {
						average[i] += pixel[i];
					};
				};

				for (var i = average.length - 1; i >= 0; i--) {
					average[i] /= height;
					average[i] = Math.floor(average[i]);
				};

				return average;
			};

			getPixel = function(ctx, x, y){
				return ctx.getImageData(x, y, 1, 1).data;
			};

			backgroundImage.addEventListener("load", loadBackground);
			if(backgroundImage.complete){
				loadBackground();
			}

		</script>

	</body>
</html>
